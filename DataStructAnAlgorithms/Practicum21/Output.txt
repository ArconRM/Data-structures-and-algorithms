Прямой обход с подсчетом глубины узлов:
